---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# tidyflow

<!-- badges: start -->
[![R build status](https://github.com/cimentadaj/tidyflow/workflows/R-CMD-check/badge.svg)](https://github.com/cimentadaj/tidyflow/actions)
[![Codecov test coverage](https://codecov.io/gh/cimentadaj/tidyflow/branch/master/graph/badge.svg)](https://codecov.io/gh/cimentadaj/tidyflow?branch=master)
<!-- badges: end -->

## What is a tidyflow? 

A tidyflow is a fork of [workflows](https://workflows.tidymodels.org/) that can bundle together your data, splitting, resampling, preprocessing, modeling, and grid search. Having all these steps separated into different objects can prove to be difficult. One can predict on the testing data by mistake, forget whether the recipe has been baked or not, or simply do not remember the name of all the tuning parameters to specify in the grid. `tidyflow` is a package aimed at bundling all of these steps into a a coherent flow. Among the advantages are:

 * You don't have to keep track of separate objects in your workspace.

 * The split, resample, recipe prepping, model fitting and grid search can be executed using a single call to `fit()`.
 
## Installation

You can install the development version from [GitHub](https://github.com/) with: 

```{r, eval = FALSE}
# install.packages("devtools")
devtools::install_github("cimentadaj/tidyflow")
```
 
## Example

Simple example:

```{r, message = FALSE, eval = FALSE}
library(tidymodels)
library(tidyflow)
```

```{r, echo = FALSE, message = FALSE}
library(rsample)
library(tune)

library(parsnip)
library(rsample)
library(dials)
library(tidyflow)
```

```{r}
# Build tidyflow
tflow <-
  mtcars %>%
  tidyflow() %>%
  plug_split(initial_split) %>%
  plug_formula(mpg ~ .) %>%
  plug_model(set_engine(linear_reg(), "lm"))

# Fit model
fit_m <- fit(tflow)

# Predict on testing
fit_m %>%
  predict_training()
```

Complex example:

```{r }
# Build tidyflow
tflow <-
  mtcars %>%
  tidyflow() %>%
  plug_split(initial_split) %>%
  plug_formula(mpg ~ .) %>%
  plug_resample(vfold_cv) %>%
  plug_grid(grid_regular) %>% 
  plug_model(set_engine(linear_reg(penalty = tune(), mixture = tune()), "glmnet"))

# Fit model
fit_m <- fit(tflow)

# Extract tuning grid
fit_m %>%
  pull_tflow_fit_tuning()

# Fit best model on the entire training data
final_m <-
  fit_m %>%
  complete_tflow(metric = "rmse")

# Predict on train
final_m %>%
  predict_training()

# Predict on testing
final_m %>%
  predict_testing()
```

## Code of Conduct

Please note that the tidyflow project is released with a [Contributor Code of Conduct](https://contributor-covenant.org/version/2/0/CODE_OF_CONDUCT.html). By contributing to this project, you agree to abide by its terms.
