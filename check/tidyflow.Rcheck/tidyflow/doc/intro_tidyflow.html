<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>An introduction to tidyflow</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">An introduction to tidyflow</h1>



<div id="high-level-description" class="section level2">
<h2>High level description</h2>
<p>The workflow in machine learning is very standard and can be summarized in these steps:</p>
<ul>
<li><p>Separate into training/testing</p></li>
<li><p>Feature engineering / Preprocessing</p></li>
<li><p>Cross validation</p></li>
<li><p>Tuning</p></li>
<li><p>Model definition</p></li>
<li><p>Fit model</p></li>
</ul>
<p>Although some of these steps can be exchanged (feature engineering and preprocessing can be done before separating into training/testing), the process is somewhat fixed. For example, you cannot perform tuning before defining a cross-validation resample or evaluate a model without fitting it.</p>
<p><code>tidyflow</code> takes advantage of this fixed order to create a simple and easy interface to the <code>tidymodels</code> ecosystem. <code>tidyflow</code> works by defining steps which are directly mapped to the workflow defined above:</p>
<ul>
<li><p>Separate into training/testing –&gt; <code>plug_split</code></p></li>
<li><p>Feature engineering / Preprocessing –&gt; <code>plug_recipe</code> / <code>plug_formula</code></p></li>
<li><p>Cross validation –&gt; <code>plug_resample</code></p></li>
<li><p>Tuning –&gt; <code>plug_grid</code></p></li>
<li><p>Model definition –&gt; <code>plug_model</code></p></li>
<li><p>Fit a model –&gt; <code>fit</code></p></li>
</ul>
<p>Let’s work out a manual example.</p>
</div>
<div id="example" class="section level2">
<h2>Example</h2>
<p>Let’s construct a worklow that fits a linear model to <code>mtcars</code> but only on the training data:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(tidymodels)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(tidyflow)</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a>tflow &lt;-</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="st">  </span>mtcars <span class="op">%&gt;%</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="st">  </span><span class="kw">tidyflow</span>(<span class="dt">seed =</span> <span class="dv">52131</span>) <span class="op">%&gt;%</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="st">  </span><span class="kw">plug_formula</span>(mpg <span class="op">~</span><span class="st"> </span>.) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="st">  </span><span class="kw">plug_split</span>(initial_split) <span class="op">%&gt;%</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="st">  </span><span class="kw">plug_model</span>(<span class="kw">linear_reg</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">set_engine</span>(<span class="st">&quot;lm&quot;</span>))</span>
<span id="cb1-10"><a href="#cb1-10"></a></span>
<span id="cb1-11"><a href="#cb1-11"></a>tflow</span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="co">#&gt; ══ Tidyflow ════════════════════════════════════════════════════════════════════</span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co">#&gt; Data: 32 rows x 11 columns</span></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="co">#&gt; Split: initial_split w/ default args</span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="co">#&gt; Formula: mpg ~ .</span></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="co">#&gt; Resample: None</span></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="co">#&gt; Grid: None</span></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="co">#&gt; Model:</span></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="co">#&gt; Linear Regression Model Specification (regression)</span></span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="co">#&gt; </span></span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="co">#&gt; Computational engine: lm</span></span></code></pre></div>
<p>The output of <code>tflow</code> describes the current workflow definition. You might be wondering, what are these <code>initial_split</code> or <code>linear_reg()</code> expressions. <code>tidyflow</code> is built upon <code>tidymodels</code> so it works with the core functions of this ecosystem. <code>initial_split</code> is the function that separates the data into training/testing and <code>linear_reg()</code> is the model definition. With this definition, we can just <code>fit</code> the model:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>res &lt;-<span class="st"> </span><span class="kw">fit</span>(tflow)</span>
<span id="cb2-2"><a href="#cb2-2"></a>res</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">#&gt; ══ Tidyflow [trained] ══════════════════════════════════════════════════════════</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">#&gt; Data: 32 rows x 11 columns</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">#&gt; Split: initial_split w/ default args</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co">#&gt; Formula: mpg ~ .</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">#&gt; Resample: None</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co">#&gt; Grid: None</span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co">#&gt; Model:</span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co">#&gt; Linear Regression Model Specification (regression)</span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co">#&gt; </span></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="co">#&gt; Computational engine: lm </span></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co">#&gt; </span></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="co">#&gt; ══ Results ═════════════════════════════════════════════════════════════════════</span></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="co">#&gt; </span></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="co">#&gt; </span></span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="co">#&gt; Fitted model:</span></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="co">#&gt; </span></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="co">#&gt; Call:</span></span>
<span id="cb2-20"><a href="#cb2-20"></a><span class="co">#&gt; stats::lm(formula = formula, data = data)</span></span>
<span id="cb2-21"><a href="#cb2-21"></a><span class="co">#&gt; </span></span>
<span id="cb2-22"><a href="#cb2-22"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb2-23"><a href="#cb2-23"></a><span class="co">#&gt; </span></span>
<span id="cb2-24"><a href="#cb2-24"></a><span class="co">#&gt; ...</span></span>
<span id="cb2-25"><a href="#cb2-25"></a><span class="co">#&gt; and 5 more lines.</span></span></code></pre></div>
<p>The result of <code>fit</code> is the same <code>tflow</code> but with a fitted model. You might see some of the lines of the output at the bottom of the printout. We can extract the model with <code>pull_tflow_fit</code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">pull_tflow_fit</span>(res)<span class="op">$</span>fit</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co">#&gt; </span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">#&gt; Call:</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">#&gt; stats::lm(formula = formula, data = data)</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co">#&gt; </span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">#&gt; (Intercept)          cyl         disp           hp         drat           wt  </span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co">#&gt;  -3.835e+01    8.429e-01    5.648e-03    6.885e-04    2.681e+00   -4.479e+00  </span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co">#&gt;        qsec           vs           am         gear         carb  </span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co">#&gt;   3.047e+00   -4.109e+00    2.135e+00    1.200e+00   -3.165e-01</span></span></code></pre></div>
<p>Now, let’s add a preprocessing step where we normalize all variables:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>res2 &lt;-</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="st">  </span>tflow <span class="op">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="st">  </span><span class="kw">drop_formula</span>() <span class="op">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="st">  </span><span class="kw">plug_recipe</span>(<span class="op">~</span><span class="st"> </span><span class="kw">recipe</span>(mpg <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> .x) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">step_scale</span>(<span class="kw">all_predictors</span>())) <span class="op">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="st">  </span><span class="kw">fit</span>()</span>
<span id="cb4-6"><a href="#cb4-6"></a></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="kw">pull_tflow_fit</span>(res2)<span class="op">$</span>fit</span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co">#&gt; </span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co">#&gt; Call:</span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co">#&gt; stats::lm(formula = formula, data = data)</span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co">#&gt; </span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="co">#&gt; (Intercept)          cyl         disp           hp         drat           wt  </span></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="co">#&gt;   -38.34680      1.44751      0.75908      0.05288      1.45206     -4.62467  </span></span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="co">#&gt;        qsec           vs           am         gear         carb  </span></span>
<span id="cb4-16"><a href="#cb4-16"></a><span class="co">#&gt;     5.32065     -2.09136      1.08653      0.88467     -0.56773</span></span></code></pre></div>
<p><code>tidyflow</code> allows you to recycle the entire flow and drop/replace any parts that you want to. Let’s now add a cross-validation step and fit the model:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>res3 &lt;-</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="st">  </span>res2 <span class="op">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="st">  </span><span class="kw">plug_resample</span>(vfold_cv, <span class="dt">v =</span> <span class="dv">10</span>) <span class="op">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="st">  </span><span class="kw">fit</span>()</span>
<span id="cb5-5"><a href="#cb5-5"></a></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="kw">pull_tflow_fit_tuning</span>(res3)</span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co">#&gt; #  10-fold cross-validation </span></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">#&gt; # A tibble: 10 x 4</span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co">#&gt;    splits         id     .metrics         .notes          </span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="co">#&gt;    &lt;list&gt;         &lt;chr&gt;  &lt;list&gt;           &lt;list&gt;          </span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="co">#&gt;  1 &lt;split [21/3]&gt; Fold01 &lt;tibble [2 × 3]&gt; &lt;tibble [0 × 1]&gt;</span></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="co">#&gt;  2 &lt;split [21/3]&gt; Fold02 &lt;tibble [2 × 3]&gt; &lt;tibble [0 × 1]&gt;</span></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="co">#&gt;  3 &lt;split [21/3]&gt; Fold03 &lt;tibble [2 × 3]&gt; &lt;tibble [0 × 1]&gt;</span></span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="co">#&gt;  4 &lt;split [21/3]&gt; Fold04 &lt;tibble [2 × 3]&gt; &lt;tibble [0 × 1]&gt;</span></span>
<span id="cb5-15"><a href="#cb5-15"></a><span class="co">#&gt;  5 &lt;split [22/2]&gt; Fold05 &lt;tibble [2 × 3]&gt; &lt;tibble [0 × 1]&gt;</span></span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="co">#&gt;  6 &lt;split [22/2]&gt; Fold06 &lt;tibble [2 × 3]&gt; &lt;tibble [0 × 1]&gt;</span></span>
<span id="cb5-17"><a href="#cb5-17"></a><span class="co">#&gt;  7 &lt;split [22/2]&gt; Fold07 &lt;tibble [2 × 3]&gt; &lt;tibble [0 × 1]&gt;</span></span>
<span id="cb5-18"><a href="#cb5-18"></a><span class="co">#&gt;  8 &lt;split [22/2]&gt; Fold08 &lt;tibble [2 × 3]&gt; &lt;tibble [0 × 1]&gt;</span></span>
<span id="cb5-19"><a href="#cb5-19"></a><span class="co">#&gt;  9 &lt;split [22/2]&gt; Fold09 &lt;tibble [2 × 3]&gt; &lt;tibble [0 × 1]&gt;</span></span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="co">#&gt; 10 &lt;split [22/2]&gt; Fold10 &lt;tibble [2 × 3]&gt; &lt;tibble [0 × 1]&gt;</span></span></code></pre></div>
<p>When a resample has been specified, the final result of <code>fit</code> cannot be a single model as before because the model has been fitted 10 times. Instead it returns the resample object that is usually returned in <code>tidymodels</code>. In the same spirit of <code>pull_tflow_fit</code>, to extract the resample objects, we used <code>pull_tflow_fit_tuning</code>.</p>
<p><code>fit</code> will always return either a model object or a tune/resamples object depending on the <code>tidyflow</code> specification. The rules for what to expect are simple: if there’s a resample specification or a resample specification with tuning parameters, the result will be a resample dataframe, otherwise it will be a model.</p>
<p>All <code>tidymodels</code> helpers to work with resample objects work just as well. For example:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>res3 <span class="op">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="st">  </span><span class="kw">pull_tflow_fit_tuning</span>() <span class="op">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="st">  </span><span class="kw">collect_metrics</span>()</span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co">#&gt; # A tibble: 2 x 5</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co">#&gt;   .metric .estimator  mean     n std_err</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;</span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="co">#&gt; 1 rmse    standard   4.02     10  0.925 </span></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co">#&gt; 2 rsq     standard   0.965    10  0.0200</span></span></code></pre></div>
<p>Resampling is often used within a grid search context, where we want to find the most optimal value for predicting the data. <code>plug_grid</code> allows you to specify the type of grid that you want to use. For example, let’s replace our linear model with a regularized regression, find the most optimal <code>penalty</code> and <code>mixture</code> values using a regular spaced grid of values:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a></span>
<span id="cb7-2"><a href="#cb7-2"></a>res4 &lt;-</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="st">  </span>res3 <span class="op">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="st">  </span><span class="kw">plug_grid</span>(grid_regular) <span class="op">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="st">  </span><span class="kw">replace_model</span>(<span class="kw">linear_reg</span>(<span class="dt">penalty =</span> <span class="kw">tune</span>(), <span class="dt">mixture =</span> <span class="kw">tune</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">set_engine</span>(<span class="st">&quot;glmnet&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="st">  </span><span class="kw">fit</span>()</span>
<span id="cb7-7"><a href="#cb7-7"></a></span>
<span id="cb7-8"><a href="#cb7-8"></a>res4</span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="co">#&gt; ══ Tidyflow [tuned] ════════════════════════════════════════════════════════════</span></span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="co">#&gt; Data: 32 rows x 11 columns</span></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="co">#&gt; Split: initial_split w/ default args</span></span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="co">#&gt; Recipe: available</span></span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="co">#&gt; Resample: vfold_cv w/ v = ~10</span></span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="co">#&gt; Grid: grid_regular w/ default args</span></span>
<span id="cb7-15"><a href="#cb7-15"></a><span class="co">#&gt; Model:</span></span>
<span id="cb7-16"><a href="#cb7-16"></a><span class="co">#&gt; Linear Regression Model Specification (regression)</span></span>
<span id="cb7-17"><a href="#cb7-17"></a><span class="co">#&gt; </span></span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="co">#&gt; Main Arguments:</span></span>
<span id="cb7-19"><a href="#cb7-19"></a><span class="co">#&gt;   penalty = tune()</span></span>
<span id="cb7-20"><a href="#cb7-20"></a><span class="co">#&gt;   mixture = tune()</span></span>
<span id="cb7-21"><a href="#cb7-21"></a><span class="co">#&gt; </span></span>
<span id="cb7-22"><a href="#cb7-22"></a><span class="co">#&gt; Computational engine: glmnet </span></span>
<span id="cb7-23"><a href="#cb7-23"></a><span class="co">#&gt; </span></span>
<span id="cb7-24"><a href="#cb7-24"></a><span class="co">#&gt; ══ Results ═════════════════════════════════════════════════════════════════════</span></span>
<span id="cb7-25"><a href="#cb7-25"></a><span class="co">#&gt; </span></span>
<span id="cb7-26"><a href="#cb7-26"></a><span class="co">#&gt; Tuning results: </span></span>
<span id="cb7-27"><a href="#cb7-27"></a><span class="co">#&gt; </span></span>
<span id="cb7-28"><a href="#cb7-28"></a><span class="co">#&gt; # A tibble: 5 x 4</span></span>
<span id="cb7-29"><a href="#cb7-29"></a><span class="co">#&gt;   splits         id     .metrics          .notes          </span></span>
<span id="cb7-30"><a href="#cb7-30"></a><span class="co">#&gt;   &lt;list&gt;         &lt;chr&gt;  &lt;list&gt;            &lt;list&gt;          </span></span>
<span id="cb7-31"><a href="#cb7-31"></a><span class="co">#&gt; 1 &lt;split [21/3]&gt; Fold01 &lt;tibble [18 × 5]&gt; &lt;tibble [0 × 1]&gt;</span></span>
<span id="cb7-32"><a href="#cb7-32"></a><span class="co">#&gt; 2 &lt;split [21/3]&gt; Fold02 &lt;tibble [18 × 5]&gt; &lt;tibble [0 × 1]&gt;</span></span>
<span id="cb7-33"><a href="#cb7-33"></a><span class="co">#&gt; 3 &lt;split [21/3]&gt; Fold03 &lt;tibble [18 × 5]&gt; &lt;tibble [0 × 1]&gt;</span></span>
<span id="cb7-34"><a href="#cb7-34"></a><span class="co">#&gt; 4 &lt;split [21/3]&gt; Fold04 &lt;tibble [18 × 5]&gt; &lt;tibble [0 × 1]&gt;</span></span>
<span id="cb7-35"><a href="#cb7-35"></a><span class="co">#&gt; 5 &lt;split [22/2]&gt; Fold05 &lt;tibble [18 × 5]&gt; &lt;tibble [0 × 1]&gt;</span></span>
<span id="cb7-36"><a href="#cb7-36"></a><span class="co">#&gt; </span></span>
<span id="cb7-37"><a href="#cb7-37"></a><span class="co">#&gt; ... and 5 more lines.</span></span></code></pre></div>
<p>Since we specified a resampling with a grid search, the result will be a resample/tuning object. We can extract it with <code>pull_tflow_fit_tuning</code> and check which are the best tuning values:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a></span>
<span id="cb8-2"><a href="#cb8-2"></a>res4 <span class="op">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="st">  </span><span class="kw">pull_tflow_fit_tuning</span>() <span class="op">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="st">  </span><span class="kw">select_best</span>(<span class="dt">metric =</span> <span class="st">&quot;rmse&quot;</span>)</span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co">#&gt; # A tibble: 1 x 2</span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co">#&gt;   penalty mixture</span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co">#&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co">#&gt; 1       1   0.525</span></span></code></pre></div>
<p>At this point, we need to <em>finalize</em> our <code>tidyflow</code>. This means that after figuring out which are the best tuning parameters, we want to train the model with these tuning values on the entire training data. <code>complete_tflow</code> figures out the best tuning values from the resamples object and train the model for you:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>final_model &lt;-</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="st">  </span>res4 <span class="op">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="st">  </span><span class="kw">complete_tflow</span>(<span class="dt">metric =</span> <span class="st">&quot;rmse&quot;</span>)</span>
<span id="cb9-4"><a href="#cb9-4"></a></span>
<span id="cb9-5"><a href="#cb9-5"></a>final_model</span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co">#&gt; ══ Tidyflow [trained] ══════════════════════════════════════════════════════════</span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">#&gt; Data: 32 rows x 11 columns</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">#&gt; Split: initial_split w/ default args</span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co">#&gt; Recipe: available</span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">#&gt; Resample: vfold_cv w/ v = ~10</span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co">#&gt; Grid: grid_regular w/ default args</span></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co">#&gt; Model:</span></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co">#&gt; Linear Regression Model Specification (regression)</span></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co">#&gt; </span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="co">#&gt; Main Arguments:</span></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="co">#&gt;   penalty = 1</span></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="co">#&gt;   mixture = 0.525</span></span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="co">#&gt; </span></span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="co">#&gt; Computational engine: glmnet </span></span>
<span id="cb9-20"><a href="#cb9-20"></a><span class="co">#&gt; </span></span>
<span id="cb9-21"><a href="#cb9-21"></a><span class="co">#&gt; ══ Results ═════════════════════════════════════════════════════════════════════</span></span>
<span id="cb9-22"><a href="#cb9-22"></a><span class="co">#&gt; </span></span>
<span id="cb9-23"><a href="#cb9-23"></a><span class="co">#&gt; Tuning results: </span></span>
<span id="cb9-24"><a href="#cb9-24"></a><span class="co">#&gt; </span></span>
<span id="cb9-25"><a href="#cb9-25"></a><span class="co">#&gt; # A tibble: 5 x 4</span></span>
<span id="cb9-26"><a href="#cb9-26"></a><span class="co">#&gt;   splits         id     .metrics          .notes          </span></span>
<span id="cb9-27"><a href="#cb9-27"></a><span class="co">#&gt;   &lt;list&gt;         &lt;chr&gt;  &lt;list&gt;            &lt;list&gt;          </span></span>
<span id="cb9-28"><a href="#cb9-28"></a><span class="co">#&gt; 1 &lt;split [21/3]&gt; Fold01 &lt;tibble [18 × 5]&gt; &lt;tibble [0 × 1]&gt;</span></span>
<span id="cb9-29"><a href="#cb9-29"></a><span class="co">#&gt; 2 &lt;split [21/3]&gt; Fold02 &lt;tibble [18 × 5]&gt; &lt;tibble [0 × 1]&gt;</span></span>
<span id="cb9-30"><a href="#cb9-30"></a><span class="co">#&gt; 3 &lt;split [21/3]&gt; Fold03 &lt;tibble [18 × 5]&gt; &lt;tibble [0 × 1]&gt;</span></span>
<span id="cb9-31"><a href="#cb9-31"></a><span class="co">#&gt; 4 &lt;split [21/3]&gt; Fold04 &lt;tibble [18 × 5]&gt; &lt;tibble [0 × 1]&gt;</span></span>
<span id="cb9-32"><a href="#cb9-32"></a><span class="co">#&gt; 5 &lt;split [22/2]&gt; Fold05 &lt;tibble [18 × 5]&gt; &lt;tibble [0 × 1]&gt;</span></span>
<span id="cb9-33"><a href="#cb9-33"></a><span class="co">#&gt; </span></span>
<span id="cb9-34"><a href="#cb9-34"></a><span class="co">#&gt; ... and 5 more lines.</span></span>
<span id="cb9-35"><a href="#cb9-35"></a><span class="co">#&gt; </span></span>
<span id="cb9-36"><a href="#cb9-36"></a><span class="co">#&gt; </span></span>
<span id="cb9-37"><a href="#cb9-37"></a><span class="co">#&gt; Fitted model:</span></span>
<span id="cb9-38"><a href="#cb9-38"></a><span class="co">#&gt; </span></span>
<span id="cb9-39"><a href="#cb9-39"></a><span class="co">#&gt; Call:  glmnet::glmnet(x = as.matrix(x), y = y, family = &quot;gaussian&quot;,      alpha = ~0.525) </span></span>
<span id="cb9-40"><a href="#cb9-40"></a><span class="co">#&gt; </span></span>
<span id="cb9-41"><a href="#cb9-41"></a><span class="co">#&gt;    Df    %Dev  Lambda</span></span>
<span id="cb9-42"><a href="#cb9-42"></a><span class="co">#&gt; 1   0 0.00000 10.1100</span></span>
<span id="cb9-43"><a href="#cb9-43"></a><span class="co">#&gt; </span></span>
<span id="cb9-44"><a href="#cb9-44"></a><span class="co">#&gt; ...</span></span>
<span id="cb9-45"><a href="#cb9-45"></a><span class="co">#&gt; and 86 more lines.</span></span></code></pre></div>
<p>One of the advantages of <code>tidyflow</code> is that it was built to work well within the machine learning workflow. To use this model to predict on the training data, you only have to call <code>predict_training</code>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>final_model <span class="op">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="st">  </span><span class="kw">predict_training</span>()</span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="co">#&gt; # A tibble: 24 x 12</span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co">#&gt;      mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb .pred</span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co">#&gt;  1  21       6  160    110  3.9   2.62  16.5     0     1     4     4  22.5</span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">#&gt;  2  21       6  160    110  3.9   2.88  17.0     0     1     4     4  22.1</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co">#&gt;  3  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1  21.0</span></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="co">#&gt;  4  18.7     8  360    175  3.15  3.44  17.0     0     0     3     2  17.8</span></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co">#&gt;  5  18.1     6  225    105  2.76  3.46  20.2     1     0     3     1  20.5</span></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="co">#&gt;  6  14.3     8  360    245  3.21  3.57  15.8     0     0     3     4  15.5</span></span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="co">#&gt;  7  24.4     4  147.    62  3.69  3.19  20       1     0     4     2  22.9</span></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="co">#&gt;  8  19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4  19.5</span></span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="co">#&gt;  9  17.8     6  168.   123  3.92  3.44  18.9     1     0     4     4  19.6</span></span>
<span id="cb10-15"><a href="#cb10-15"></a><span class="co">#&gt; 10  10.4     8  472    205  2.93  5.25  18.0     0     0     3     4  12.6</span></span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="co">#&gt; # … with 14 more rows</span></span></code></pre></div>
<p>Similarly, you can use <code>predict_testing</code>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>final_model <span class="op">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="st">  </span><span class="kw">predict_testing</span>()</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co">#&gt; # A tibble: 8 x 12</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co">#&gt;     mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb .pred</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co">#&gt; 1  22.8     4 108      93  3.85  2.32  18.6     1     1     4     1  26.0</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co">#&gt; 2  22.8     4 141.     95  3.92  3.15  22.9     1     0     4     2  22.7</span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co">#&gt; 3  16.4     8 276.    180  3.07  4.07  17.4     0     0     3     3  16.2</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co">#&gt; 4  17.3     8 276.    180  3.07  3.73  17.6     0     0     3     3  16.9</span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co">#&gt; 5  15.2     8 276.    180  3.07  3.78  18       0     0     3     3  16.8</span></span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="co">#&gt; 6  15.5     8 318     150  2.76  3.52  16.9     0     0     3     2  17.9</span></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="co">#&gt; 7  15.2     8 304     150  3.15  3.44  17.3     0     0     3     2  18.3</span></span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="co">#&gt; 8  30.4     4  95.1   113  3.77  1.51  16.9     1     1     5     2  26.7</span></span></code></pre></div>
<p>These functions are useful because they’re safe: it’s not rare that you mistakenly predict on the testing data thinking it was the training data or that you forget to apply all of the preprocessing on the testing data. The <code>predict_*</code> functions take care of applying all of your preprocessing on either the training or testing data, freeing the user of having to remember all these different things.</p>
<p>Although this brief tutorial walked you through a <code>tidyflow</code> step by step, the richness of <code>tidyflow</code> is that it allows you to express this pipeline very quickly and to iterate as quickly as possible. For example, we can summarize the entire steps from before in a quick and readable expression:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>tflow &lt;-</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="st">  </span>mtcars <span class="op">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="st">  </span><span class="kw">tidyflow</span>(<span class="dt">seed =</span> <span class="dv">52131</span>) <span class="op">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="st">  </span><span class="kw">plug_recipe</span>(<span class="op">~</span><span class="st"> </span><span class="kw">recipe</span>(mpg <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> .x) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">step_scale</span>(<span class="kw">all_predictors</span>())) <span class="op">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="st">  </span><span class="kw">plug_split</span>(initial_split) <span class="op">%&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="st">  </span><span class="kw">plug_resample</span>(vfold_cv) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="st">  </span><span class="kw">plug_grid</span>(grid_regular) <span class="op">%&gt;%</span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="st">  </span><span class="kw">plug_model</span>(<span class="kw">linear_reg</span>(<span class="dt">penalty =</span> <span class="kw">tune</span>(), <span class="dt">mixture =</span> <span class="kw">tune</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">set_engine</span>(<span class="st">&quot;glmnet&quot;</span>))</span>
<span id="cb12-9"><a href="#cb12-9"></a></span>
<span id="cb12-10"><a href="#cb12-10"></a>tflow <span class="op">%&gt;%</span></span>
<span id="cb12-11"><a href="#cb12-11"></a><span class="st">  </span><span class="kw">fit</span>() <span class="op">%&gt;%</span></span>
<span id="cb12-12"><a href="#cb12-12"></a><span class="st">  </span><span class="kw">pull_tflow_fit_tuning</span>() <span class="op">%&gt;%</span></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="st">  </span><span class="kw">collect_metrics</span>()</span>
<span id="cb12-14"><a href="#cb12-14"></a><span class="co">#&gt; # A tibble: 18 x 7</span></span>
<span id="cb12-15"><a href="#cb12-15"></a><span class="co">#&gt;         penalty mixture .metric .estimator  mean     n std_err</span></span>
<span id="cb12-16"><a href="#cb12-16"></a><span class="co">#&gt;           &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;</span></span>
<span id="cb12-17"><a href="#cb12-17"></a><span class="co">#&gt;  1 0.0000000001   0.05  rmse    standard   3.92     10  0.878 </span></span>
<span id="cb12-18"><a href="#cb12-18"></a><span class="co">#&gt;  2 0.0000000001   0.05  rsq     standard   0.964    10  0.0200</span></span>
<span id="cb12-19"><a href="#cb12-19"></a><span class="co">#&gt;  3 0.0000000001   0.525 rmse    standard   3.98     10  0.905 </span></span>
<span id="cb12-20"><a href="#cb12-20"></a><span class="co">#&gt;  4 0.0000000001   0.525 rsq     standard   0.964    10  0.0199</span></span>
<span id="cb12-21"><a href="#cb12-21"></a><span class="co">#&gt;  5 0.0000000001   1     rmse    standard   3.98     10  0.908 </span></span>
<span id="cb12-22"><a href="#cb12-22"></a><span class="co">#&gt;  6 0.0000000001   1     rsq     standard   0.965    10  0.0199</span></span>
<span id="cb12-23"><a href="#cb12-23"></a><span class="co">#&gt;  7 0.00001        0.05  rmse    standard   3.92     10  0.878 </span></span>
<span id="cb12-24"><a href="#cb12-24"></a><span class="co">#&gt;  8 0.00001        0.05  rsq     standard   0.964    10  0.0200</span></span>
<span id="cb12-25"><a href="#cb12-25"></a><span class="co">#&gt;  9 0.00001        0.525 rmse    standard   3.98     10  0.905 </span></span>
<span id="cb12-26"><a href="#cb12-26"></a><span class="co">#&gt; 10 0.00001        0.525 rsq     standard   0.964    10  0.0199</span></span>
<span id="cb12-27"><a href="#cb12-27"></a><span class="co">#&gt; 11 0.00001        1     rmse    standard   3.98     10  0.908 </span></span>
<span id="cb12-28"><a href="#cb12-28"></a><span class="co">#&gt; 12 0.00001        1     rsq     standard   0.965    10  0.0199</span></span>
<span id="cb12-29"><a href="#cb12-29"></a><span class="co">#&gt; 13 1              0.05  rmse    standard   2.84     10  0.380 </span></span>
<span id="cb12-30"><a href="#cb12-30"></a><span class="co">#&gt; 14 1              0.05  rsq     standard   0.946    10  0.0448</span></span>
<span id="cb12-31"><a href="#cb12-31"></a><span class="co">#&gt; 15 1              0.525 rmse    standard   2.83     10  0.430 </span></span>
<span id="cb12-32"><a href="#cb12-32"></a><span class="co">#&gt; 16 1              0.525 rsq     standard   0.944    10  0.0436</span></span>
<span id="cb12-33"><a href="#cb12-33"></a><span class="co">#&gt; 17 1              1     rmse    standard   2.85     10  0.383 </span></span>
<span id="cb12-34"><a href="#cb12-34"></a><span class="co">#&gt; 18 1              1     rsq     standard   0.917    10  0.0638</span></span></code></pre></div>
<p><code>tidyflow</code> has several advantages:</p>
<ul>
<li><p>You only specify the data once (no need to pass it to the recipe, the split, the cross-validation, the final fitting, the predicting, etc…)</p></li>
<li><p>You provide a seed in the <code>tidyflow</code> and it makes sure the same <code>tidyflow</code> is <strong>always</strong> reproducible</p></li>
<li><p>No need to deal with separate objects (training data, cross-validated set, separate tuning grid, separate recipe)</p></li>
<li><p>No need to remember which <code>fit</code> function to use (<code>fit_resample</code>, <code>tune_grid</code>, <code>fit</code>): <code>fit</code> takes care of that and always returns either a model or a resamples/tune object</p></li>
<li><p>It’s very safe with respect to the training/testing dataset: everything is applied on the training data by default and <code>predict_training</code> and <code>predict_testing</code> make sure that you never have to do predictions manually, avoiding unexpected mistakes.</p></li>
<li><p>You can replace any step with ease. For example, you can build a complex workflow with a particular dataset and simply replace the data with a new data source and execute the <code>tidyflow</code>. In other settings, this means that you have to replace the data slot in the recipe, the split, the cross-validation, etc..</p></li>
</ul>
</div>
<div id="what-is-expected" class="section level2">
<h2>What is expected?</h2>
<p>All <code>plug_*</code> functions and <code>tidyflow()</code> return a <code>tidyflow</code> object. However, what do they accept? The first argument is always a <code>tidyflow</code> and the remaining arguments add the steps used in the analysis. Below is a lookup table of what each accepts:</p>
<ul>
<li><p><code>plug_split</code>: a function to be applied to the data. This is assumed to be a function such as <code>initial_split</code> or similar functions from the <code>rsample</code> package.</p></li>
<li><p><code>plug_formula</code>: the formula of the model definition. A <code>tidyflow</code> needs to specify either a formula or a recipe, <strong>but not both</strong>.</p></li>
<li><p><code>plug_recipe</code>: a formula containing a recipe that will be applied to the training data. A <code>tidyflow</code> needs to specify either a formula or a recipe, <strong>but not both</strong>.</p></li>
<li><p><code>plug_resample</code>: a function to be applied to the preprocessed data. This is assumed to be a function such as <code>vfold_cv</code> or similar functions from the <code>rsample</code> package.</p></li>
<li><p><code>plug_grid</code>: a function to be applied to the tuning placeholders in the recipe or the data. This is assumed to be a function such as <code>grid_regular</code> or similar functions from the <code>dials</code> package.</p></li>
<li><p><code>plug_model</code>: a model object from packages such as <code>parsnip</code>.</p></li>
</ul>
<p>Despite these <code>plug_*</code> not having a single unified interface on which arguments they accept, we believe these <code>plug_*</code> functions are easy to remember as they can be mapped directly to the machine learning workflow. Any feedback on how to improve the interface or functionality is more than welcome. Please file an issue on Github <a href="https://github.com/cimentadaj/tidyflow/issues">here</a>.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
